(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3647:function(e,s,t){Promise.resolve().then(t.bind(t,7040))},7040:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ei}});var r=t(7437),a=t(9376),l=t(2381),n=t(279),i=t(5060),o=t(7648),c=t(2265),d=t(7603),m=t(6237),u=t(1755),x=t(3270),p=t(3247),h=t(4924),f=t(3581),j=t(5805),g=t(8462),v=t(9334),N=t(8728),b=t(9397),y=t(2369),w=t(7692),C=t(8293),S=t(6901),k=t(4766),z=t(112),Z=t(7684),I=t(2208),D=t(5675),_=t(8867),O=t(8930),V=t(3113),P=t(2735),A=t(8736),R=t(5291),M=t(9270),F=t(401),T=t(3448);let E=c.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(M.fC,{ref:s,className:(0,T.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:(0,r.jsx)(M.z$,{className:(0,T.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(F.Z,{className:"h-4 w-4"})})})});E.displayName=M.fC.displayName;var J=t(4589),L=t(4291),q=t(3032),Q=t(407),$=t(519);let U=q.fC,B=q.xz;q.ZA,q.Uv,q.Tr,q.Ee,c.forwardRef((e,s)=>{let{className:t,inset:a,children:l,...n}=e;return(0,r.jsxs)(q.fF,{ref:s,className:(0,T.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",t),...n,children:[l,(0,r.jsx)(Q.Z,{className:"ml-auto"})]})}).displayName=q.fF.displayName,c.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(q.tu,{ref:s,className:(0,T.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a})}).displayName=q.tu.displayName;let Y=c.forwardRef((e,s)=>{let{className:t,sideOffset:a=4,...l}=e;return(0,r.jsx)(q.Uv,{children:(0,r.jsx)(q.VY,{ref:s,sideOffset:a,className:(0,T.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})})});Y.displayName=q.VY.displayName;let G=c.forwardRef((e,s)=>{let{className:t,inset:a,...l}=e;return(0,r.jsx)(q.ck,{ref:s,className:(0,T.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",t),...l})});G.displayName=q.ck.displayName,c.forwardRef((e,s)=>{let{className:t,children:a,checked:l,...n}=e;return(0,r.jsxs)(q.oC,{ref:s,className:(0,T.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:l,...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(q.wU,{children:(0,r.jsx)(F.Z,{className:"h-4 w-4"})})}),a]})}).displayName=q.oC.displayName,c.forwardRef((e,s)=>{let{className:t,children:a,...l}=e;return(0,r.jsxs)(q.Rk,{ref:s,className:(0,T.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(q.wU,{children:(0,r.jsx)($.Z,{className:"h-2 w-2 fill-current"})})}),a]})}).displayName=q.Rk.displayName,c.forwardRef((e,s)=>{let{className:t,inset:a,...l}=e;return(0,r.jsx)(q.__,{ref:s,className:(0,T.cn)("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",t),...l})}).displayName=q.__.displayName;let K=c.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(q.Z0,{ref:s,className:(0,T.cn)("-mx-1 my-1 h-px bg-muted",t),...a})});K.displayName=q.Z0.displayName;var H=t(610);let W=c.forwardRef((e,s)=>{let{className:t,value:a,...l}=e;return(0,r.jsx)(H.fC,{ref:s,className:(0,T.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...l,children:(0,r.jsx)(H.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});W.displayName=H.fC.displayName;var X=t(3340),ee=t(8421),es=t(1841),et=t(767);let er=[{id:"proj_1",name:"Photos Trimestrielles",createdDate:"15 mai 2025",color:"bg-primary",iconColor:"bg-blue-100 text-primary"},{id:"proj_2",name:"Photos de Classe",createdDate:"10 avril 2025",color:"bg-green-500",iconColor:"bg-green-100 text-green-600"},{id:"proj_3",name:"Portraits Individuels",createdDate:"5 mai 2025",color:"bg-purple-500",iconColor:"bg-purple-100 text-purple-600"},{id:"proj_4",name:"Journ\xe9e Sportive",createdDate:"18 mai 2025",color:"bg-amber-500",iconColor:"bg-amber-100 text-amber-600"},{id:"proj_5",name:"F\xeate de l'\xc9cole",createdDate:"1 mai 2025",color:"bg-red-500",iconColor:"bg-red-100 text-red-600"}],ea="photoClassAppProjects",el="photoClassAppSchoolClasses",en="photoClassProjectStudents_";function ei(){let e=(0,a.useRouter)(),{toast:s}=(0,X.pm)(),[t,M]=(0,c.useState)([]),[F,q]=(0,c.useState)(!0),[Q,$]=(0,c.useState)(!1),[H,ei]=(0,c.useState)(!1),[eo,ec]=(0,c.useState)(!1),[ed,em]=(0,c.useState)(null),[eu,ex]=(0,c.useState)(null),[ep,eh]=(0,c.useState)(""),[ef,ej]=(0,c.useState)(null),[eg,ev]=(0,c.useState)([]),[eN,eb]=(0,c.useState)(!1),[ey,ew]=(0,c.useState)(""),[eC,eS]=(0,c.useState)(null),[ek,ez]=(0,c.useState)(!1),[eZ,eI]=(0,c.useState)(null),[eD,e_]=(0,c.useState)(null),eO=(0,c.useRef)(null),eV=async()=>{let e;q(!0);{let s=localStorage.getItem(ea);if(s)try{let t=JSON.parse(s);e=Array.isArray(t)?t:er,Array.isArray(t)||localStorage.setItem(ea,JSON.stringify(e))}catch(s){console.error("Failed to parse projects from localStorage",s),e=er,localStorage.setItem(ea,JSON.stringify(e))}else e=er,localStorage.setItem(ea,JSON.stringify(e));let t=localStorage.getItem(el);if(t)try{let e=JSON.parse(t);ev(Array.isArray(e)?e:[])}catch(e){console.error("Failed to parse school classes from localStorage",e),ev([])}else ev([]),localStorage.setItem(el,JSON.stringify([]))}let s=await (0,es.Mr)(),t=new Map;s.forEach(e=>{var s;t.has(e.projectId)||t.set(e.projectId,[]),null===(s=t.get(e.projectId))||void 0===s||s.push(e)}),M(await Promise.all(e.map(async e=>{try{let s=[];{let t=localStorage.getItem("".concat(en).concat(e.id));s=t?JSON.parse(t):[]}let r=s.length,a=t.get(e.id)||[],l=a.length,n=0;if(r>0&&a.length>0){let e=new Set(a.map(e=>e.studentId)),t=s.filter(s=>e.has(s.id)).length;n=Math.round(t/r*100)}else n=0;return{...e,students:r,photos:l,progress:n}}catch(s){return console.error("Failed to get counts for project ".concat(e.id),s),{...e,students:0,photos:0,progress:0}}}))),q(!1)};(0,c.useEffect)(()=>{eV()},[]),(0,c.useEffect)(()=>{eS((0,d.Z)(new Date,"d MMMM yyyy, HH:mm",{locale:x.Z}))},[]);let eP=e=>{M(s=>{let t="function"==typeof e?e(s):e;{let e=t.map(e=>{let{students:s,photos:t,progress:r,...a}=e;return a});localStorage.setItem(ea,JSON.stringify(e))}return t})},eA=e=>{ev(s=>{let t="function"==typeof e?e(s):e;return localStorage.setItem(el,JSON.stringify(t)),t})},eR=async()=>{if(!ep.trim()){s({title:"Nom du projet requis",description:"Veuillez entrer un nom pour le projet.",variant:"destructive"});return}if(ef)eP(e=>e.map(e=>e.id===ef?{...e,name:ep.trim()}:e)),s({title:"Projet modifi\xe9",description:'Le projet "'.concat(ep.trim(),'" a \xe9t\xe9 mis \xe0 jour.')});else{let e={id:"proj_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,7)),name:ep.trim(),progress:0,students:0,photos:0,createdDate:(0,d.Z)(new Date,"d MMMM yyyy",{locale:x.Z}),color:"bg-primary",iconColor:"bg-blue-100 text-primary"};eP(s=>[e,...s]),s({title:"Projet cr\xe9\xe9",description:'Le projet "'.concat(e.name,'" a \xe9t\xe9 configur\xe9.')})}$(!1),eh(""),ej(null),await eV()},eM=()=>{ej(null),eh(""),$(!0),em(null)},eF=e=>{let s=t.find(s=>s.id===e);s&&(ej(e),eh(s.name),$(!0),em(null))},eT=async()=>{if(eu)try{await (0,es.tD)(eu),localStorage.removeItem("".concat(en).concat(eu)),eP(e=>e.filter(e=>e.id!==eu)),s({title:"Projet supprim\xe9",description:"Le projet, ses photos et sa liste d'\xe9l\xe8ves ont \xe9t\xe9 supprim\xe9s.",variant:"destructive"})}catch(e){s({title:"Erreur de suppression",description:"Impossible de supprimer le projet ou ses donn\xe9es associ\xe9es.",variant:"destructive"})}ec(!1),ex(null),em(null)},eE=e=>{ex(e),ec(!0),em(null)},eJ=async()=>{if(!eZ){s({variant:"destructive",title:"Aucun projet s\xe9lectionn\xe9",description:"Veuillez s\xe9lectionner un projet."});return}if(!eD){s({variant:"destructive",title:"Aucun fichier s\xe9lectionn\xe9",description:"Veuillez s\xe9lectionner un fichier CSV."});return}let e=new FileReader;e.onload=async e=>{var t;let r=null===(t=e.target)||void 0===t?void 0:t.result;if(!r){s({variant:"destructive",title:"Fichier vide",description:"Le fichier CSV s\xe9lectionn\xe9 est vide."});return}try{let e=r.split(/\r\n|\n/).filter(e=>""!==e.trim());if(e.length<=1){s({variant:"destructive",title:"Format CSV incorrect",description:"Le fichier CSV doit contenir un en-t\xeate et au moins une ligne de donn\xe9es."});return}let t=e[0].split(",").map(e=>e.trim().toLowerCase()),a=t.indexOf("pr\xe9nom"),l=t.indexOf("nom"),n=t.indexOf("classe");if(-1===a||-1===l||-1===n){s({variant:"destructive",title:"En-t\xeates CSV manquants",description:"Le CSV doit contenir les colonnes: Pr\xe9nom, Nom, Classe."});return}let i=e.slice(1).map((e,s)=>{let t=e.split(",").map(e=>e.trim());return{id:"student_".concat(eZ,"_csv_").concat(Date.now(),"_").concat(s),firstName:t[a]||"Pr\xe9nomInconnu".concat(s),lastName:t[l]||"NomInconnu".concat(s),className:t[n]||"ClasseInconnue"}});if(i.length>0){let e="".concat(en).concat(eZ),t=localStorage.getItem(e),r=t?JSON.parse(t):[],a=new Set(r.map(e=>e.id)),l=i.filter(e=>!a.has(e.id)),n=[...r,...l];localStorage.setItem(e,JSON.stringify(n)),s({title:"\xc9l\xe8ves import\xe9s",description:"".concat(i.length," \xe9l\xe8ves trait\xe9s. ").concat(l.length," nouveaux \xe9l\xe8ves ajout\xe9s pour le projet.")}),ez(!1),await eV()}else s({variant:"destructive",title:"Aucun \xe9l\xe8ve import\xe9",description:"Aucun \xe9l\xe8ve n'a \xe9t\xe9 trouv\xe9 dans le fichier CSV."})}catch(e){console.error("Error parsing CSV:",e),s({variant:"destructive",title:"Erreur de parsing CSV",description:"Impossible de lire le fichier CSV. V\xe9rifiez son format."})}},e.readAsText(eD)};return(0,r.jsxs)("div",{className:"flex h-screen overflow-hidden bg-background",children:[(0,r.jsx)("div",{className:"sidebar bg-sidebar-background w-64 flex-shrink-0 hidden md:block",children:(0,r.jsxs)("div",{className:"h-full flex flex-col",children:[(0,r.jsx)("div",{className:"p-4 border-b border-sidebar-border flex items-center",children:(0,r.jsx)(ee.Y,{})}),(0,r.jsxs)("nav",{className:"flex-1 overflow-y-auto py-4",children:[(0,r.jsx)("div",{className:"px-4 mb-6",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(p.Z,{className:"w-5 h-5 text-sidebar-muted-foreground"})}),(0,r.jsx)(n.I,{type:"text",className:"search-input block w-full pl-10 pr-3 py-2 border-sidebar-border rounded-md text-sm placeholder-sidebar-muted-foreground focus:outline-none focus:border-primary transition duration-150 ease-in-out bg-background",placeholder:"Rechercher..."})]})}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)(o.default,{href:"/",className:"flex items-center px-4 py-3 text-sm font-medium text-sidebar-active-foreground bg-sidebar-active-background rounded-r-full",children:[(0,r.jsx)(h.Z,{className:"w-5 h-5 mr-3"}),(0,r.jsx)("span",{children:"Projets"})]}),(0,r.jsxs)(o.default,{href:"/capture",className:"flex items-center px-4 py-3 text-sm font-medium text-sidebar-foreground hover:text-sidebar-active-foreground hover:bg-sidebar-active-background rounded-r-full",children:[(0,r.jsx)(f.Z,{className:"w-5 h-5 mr-3"}),(0,r.jsx)("span",{children:"Capture Photos"})]}),(0,r.jsxs)("a",{href:"#",className:"flex items-center px-4 py-3 text-sm font-medium text-sidebar-foreground hover:text-sidebar-active-foreground hover:bg-sidebar-active-background rounded-r-full",children:[(0,r.jsx)(j.Z,{className:"w-5 h-5 mr-3"}),(0,r.jsx)("span",{children:"\xc9l\xe8ves"})]}),(0,r.jsxs)("a",{href:"#",className:"flex items-center px-4 py-3 text-sm font-medium text-sidebar-foreground hover:text-sidebar-active-foreground hover:bg-sidebar-active-background rounded-r-full",children:[(0,r.jsx)(g.Z,{className:"w-5 h-5 mr-3"}),(0,r.jsx)("span",{children:"Import Photos"})]}),(0,r.jsxs)(o.default,{href:"/archives",className:"flex items-center px-4 py-3 text-sm font-medium text-sidebar-foreground hover:text-sidebar-active-foreground hover:bg-sidebar-active-background rounded-r-full",children:[(0,r.jsx)(v.Z,{className:"w-5 h-5 mr-3"}),(0,r.jsx)("span",{children:"Archives"})]}),(0,r.jsxs)(o.default,{href:"/settings",className:"flex items-center px-4 py-3 text-sm font-medium text-sidebar-foreground hover:text-sidebar-active-foreground hover:bg-sidebar-active-background rounded-r-full",children:[(0,r.jsx)(N.Z,{className:"w-5 h-5 mr-3"}),(0,r.jsx)("span",{children:"Param\xe8tres"})]})]}),(0,r.jsxs)("div",{className:"mt-8 px-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h2",{className:"text-xs font-semibold text-sidebar-muted-foreground uppercase tracking-wider",children:"Classes"}),(0,r.jsx)(l.z,{variant:"ghost",size:"icon",className:"h-6 w-6 text-sidebar-muted-foreground hover:text-sidebar-active-foreground",onClick:()=>{ew(""),eb(!0)},children:(0,r.jsx)(b.Z,{className:"w-4 h-4"})})]}),(0,r.jsx)("div",{className:"space-y-1",children:eg.length>0?eg.map(e=>(0,r.jsx)("a",{href:"#",className:"flex items-center justify-between px-3 py-2 text-sm font-medium rounded-md text-sidebar-foreground hover:text-sidebar-active-foreground hover:bg-sidebar-active-background",children:(0,r.jsx)("span",{children:e.name})},e.id)):(0,r.jsx)("p",{className:"px-3 py-2 text-xs text-sidebar-muted-foreground",children:"Aucune classe cr\xe9\xe9e."})})]})]}),(0,r.jsx)("div",{className:"border-t border-sidebar-border p-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-muted rounded-full flex items-center justify-center",children:(0,r.jsx)(y.Z,{className:"w-5 h-5 text-muted-foreground"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Sophie Dubois"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Photographe"})]}),(0,r.jsx)(l.z,{variant:"ghost",size:"icon",className:"ml-auto p-1 text-muted-foreground hover:text-foreground",children:(0,r.jsx)(w.Z,{className:"w-5 h-5"})})]})})]})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,r.jsx)("header",{className:"bg-card border-b border-border",children:(0,r.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center md:hidden",children:[(0,r.jsx)(l.z,{variant:"ghost",size:"icon",className:"p-2 text-muted-foreground hover:text-foreground",children:(0,r.jsx)(C.Z,{className:"w-6 h-6"})}),(0,r.jsx)("h1",{className:"ml-2 text-lg font-semibold text-foreground",children:"Projets"})]}),(0,r.jsx)("div",{className:"hidden md:flex items-center",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[(0,r.jsx)(S.Z,{className:"w-4 h-4 text-green-500 mr-1"}),(0,r.jsx)("span",{children:"Synchronis\xe9"}),(0,r.jsx)("span",{children:"â€¢"}),eC?(0,r.jsxs)("span",{children:["Derni\xe8re mise \xe0 jour: ",eC]}):(0,r.jsx)("span",{children:"Chargement..."})]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)(l.z,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground relative",children:[(0,r.jsx)(k.Z,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),(0,r.jsx)(l.z,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground",children:(0,r.jsx)(z.Z,{className:"w-5 h-5"})})]})]})}),(0,r.jsx)("main",{className:"flex-1 overflow-y-auto bg-background p-4 sm:p-6 lg:p-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"md:flex md:items-center md:justify-between mb-6",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold leading-7 text-foreground sm:text-3xl sm:truncate",children:"Projets"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"G\xe9rez vos projets photo et vos listes d'\xe9l\xe8ves"})]}),(0,r.jsxs)("div",{className:"mt-4 flex md:mt-0 md:ml-4 space-x-3",children:[(0,r.jsxs)(l.z,{variant:"outline",className:"whitespace-nowrap",onClick:()=>{if(0===t.length){s({variant:"destructive",title:"Aucun projet",description:"Veuillez d'abord cr\xe9er un projet pour y importer des \xe9l\xe8ves."});return}eI(null),e_(null),eO.current&&(eO.current.value=""),ez(!0)},children:[(0,r.jsx)(g.Z,{className:"w-5 h-5 mr-2"}),"Importer CSV"]}),(0,r.jsxs)(l.z,{className:"whitespace-nowrap",onClick:eM,children:[(0,r.jsx)(b.Z,{className:"w-5 h-5 mr-2"}),"Nouveau projet"]})]})]}),(0,r.jsx)("div",{className:"bg-card rounded-lg shadow-sm p-4 mb-6 border border-border",children:(0,r.jsxs)("div",{className:"sm:flex sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(p.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground pointer-events-none"}),(0,r.jsx)(n.I,{type:"text",className:"search-input block w-full pl-10 pr-3 py-2 border-border rounded-md text-sm placeholder-muted-foreground focus:outline-none focus:border-primary transition duration-150 ease-in-out bg-background",placeholder:"Rechercher un projet..."})]}),(0,r.jsx)("div",{className:"hidden sm:block",children:(0,r.jsxs)(R.Ph,{defaultValue:"all",children:[(0,r.jsx)(R.i4,{className:"w-[180px] bg-background",children:(0,r.jsx)(R.ki,{placeholder:"Tous les projets"})}),(0,r.jsxs)(R.Bw,{children:[(0,r.jsx)(R.Ql,{value:"all",children:"Tous les projets"}),(0,r.jsx)(R.Ql,{value:"active",children:"Projets actifs"}),(0,r.jsx)(R.Ql,{value:"archived",children:"Projets archiv\xe9s"})]})]})})]}),(0,r.jsxs)("div",{className:"mt-3 sm:mt-0 flex items-center space-x-2 text-sm text-muted-foreground",children:[(0,r.jsx)("span",{children:"Trier par:"}),(0,r.jsxs)(R.Ph,{defaultValue:"recent",children:[(0,r.jsx)(R.i4,{className:"w-[180px] bg-background",children:(0,r.jsx)(R.ki,{placeholder:"Date (r\xe9cent)"})}),(0,r.jsxs)(R.Bw,{children:[(0,r.jsx)(R.Ql,{value:"recent",children:"Date (r\xe9cent)"}),(0,r.jsx)(R.Ql,{value:"oldest",children:"Date (ancien)"}),(0,r.jsx)(R.Ql,{value:"name",children:"Nom (A-Z)"}),(0,r.jsx)(R.Ql,{value:"progress",children:"Progression"})]})]})]})]})}),F?(0,r.jsx)("p",{className:"text-center text-muted-foreground",children:"Chargement des informations des projets..."}):(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:[t.map(t=>(0,r.jsxs)("div",{className:(0,T.cn)("project-card bg-card overflow-hidden rounded-lg shadow-sm border border-border h-[215px]",ed===t.id&&"project-card-menu-open"),children:[(0,r.jsxs)("div",{className:"p-5",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:(0,T.cn)("w-10 h-10 flex items-center justify-center rounded-lg",t.iconColor),children:(0,r.jsx)(h.Z,{size:20})}),(0,r.jsx)("h3",{className:"ml-3 text-lg font-medium text-foreground",children:t.name})]}),(0,r.jsxs)(U,{open:ed===t.id,onOpenChange:e=>{em(e?t.id:null)},children:[(0,r.jsx)(B,{asChild:!0,children:(0,r.jsx)(l.z,{variant:"ghost",size:"icon",className:"p-1 text-muted-foreground hover:text-foreground h-auto w-auto",children:(0,r.jsx)(Z.Z,{className:"w-5 h-5"})})}),(0,r.jsxs)(Y,{align:"end",children:[(0,r.jsxs)(G,{onClick:()=>{try{let e=new Date().toISOString().split("T")[0];if(t.createdDate){let s=(0,m.Z)(t.createdDate,"d MMMM yyyy",new Date,{locale:x.Z});(0,u.Z)(s)?e=s.toISOString().split("T")[0]:console.warn("Invalid date parsed from project.createdDate:",t.createdDate,"Using current date as fallback.")}localStorage.setItem("projectConfig",JSON.stringify({projectId:t.id,projectName:t.name,sessionDate:e}))}catch(e){console.error("Error processing project createdDate:",t.createdDate,e),localStorage.setItem("projectConfig",JSON.stringify({projectId:t.id,projectName:t.name,sessionDate:new Date().toISOString().split("T")[0]}))}e.push("/project-details"),em(null)},children:[(0,r.jsx)(I.Z,{className:"mr-2 h-4 w-4"}),"Voir les d\xe9tails"]}),(0,r.jsxs)(G,{onClick:()=>eF(t.id),children:[(0,r.jsx)(D.Z,{className:"mr-2 h-4 w-4"}),"Modifier"]}),(0,r.jsxs)(G,{onClick:()=>{em(null),s({title:"TODO",description:"Fonction Dupliquer \xe0 impl\xe9menter"})},children:[(0,r.jsx)(_.Z,{className:"mr-2 h-4 w-4"}),"Dupliquer"]}),(0,r.jsxs)(G,{onClick:()=>{ei(!0),em(null)},children:[(0,r.jsx)(v.Z,{className:"mr-2 h-4 w-4"}),"Archiver"]}),(0,r.jsx)(K,{}),(0,r.jsxs)(G,{className:"text-destructive hover:!bg-destructive/10 focus:!bg-destructive/10 focus:!text-destructive",onClick:()=>eE(t.id),children:[(0,r.jsx)(O.Z,{className:"mr-2 h-4 w-4"}),"Supprimer"]})]})]})]}),(0,r.jsxs)("div",{className:"mt-2 mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm mb-1",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Progression"}),(0,r.jsxs)("span",{className:"font-medium text-foreground",children:[t.progress,"%"]})]}),(0,r.jsx)(W,{value:t.progress,className:(0,T.cn)("h-2",t.color.startsWith("bg-")?t.color:"bg-primary")})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(j.Z,{className:"w-4 h-4 mr-1"}),(0,r.jsxs)("span",{children:[t.students," \xe9l\xe8ve",1!==t.students?"s":""]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(V.Z,{className:"w-4 h-4 mr-1"}),(0,r.jsxs)("span",{children:[t.photos," photo",1!==t.photos?"s":""]})]})]})]}),(0,r.jsx)("div",{className:"bg-muted/50 px-5 py-3 border-t border-border",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Cr\xe9\xe9 le ",t.createdDate]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(l.z,{variant:"ghost",size:"icon",className:"p-1 text-muted-foreground hover:text-primary h-auto w-auto",children:(0,r.jsx)(P.Z,{className:"w-5 h-5"})}),(0,r.jsx)(l.z,{variant:"ghost",size:"icon",className:"p-1 text-muted-foreground hover:text-primary h-auto w-auto",onClick:()=>{try{let e=new Date().toISOString().split("T")[0];if(t.createdDate){let s=(0,m.Z)(t.createdDate,"d MMMM yyyy",new Date,{locale:x.Z});(0,u.Z)(s)?e=s.toISOString().split("T")[0]:console.warn("Invalid date parsed from project.createdDate for camera:",t.createdDate,"Using current date as fallback.")}localStorage.setItem("projectConfig",JSON.stringify({projectId:t.id,projectName:t.name,sessionDate:e}))}catch(e){console.error("Error processing project createdDate for camera button:",t.createdDate,e),localStorage.setItem("projectConfig",JSON.stringify({projectId:t.id,projectName:t.name,sessionDate:new Date().toISOString().split("T")[0]}))}e.push("/capture")},children:(0,r.jsx)(f.Z,{className:"w-5 h-5"})})]})]})})]},t.id)),(0,r.jsxs)(L.Vq,{open:Q,onOpenChange:e=>{$(e),e||(eh(""),ej(null))},children:[(0,r.jsx)("div",{className:"project-card bg-card overflow-hidden rounded-lg shadow-sm border border-border border-dashed flex items-center justify-center p-6 min-h-[260px] sm:min-h-[215px]",children:(0,r.jsxs)(l.z,{variant:"ghost",className:"flex flex-col items-center text-muted-foreground hover:text-primary transition-colors duration-200 h-full w-full group",onClick:eM,children:[(0,r.jsx)("div",{className:"w-12 h-12 flex items-center justify-center border-2 border-dashed border-muted-foreground/50 rounded-full mb-2 group-hover:border-primary",children:(0,r.jsx)(b.Z,{className:"w-6 h-6 group-hover:text-primary"})}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"Nouveau projet"})]})}),(0,r.jsxs)(L.cZ,{className:"sm:max-w-md",children:[(0,r.jsx)(L.fK,{children:(0,r.jsx)(L.$N,{children:ef?"Modifier le projet":"Cr\xe9er un nouveau projet"})}),(0,r.jsxs)("div",{className:"px-0 py-4 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(i._,{htmlFor:"projectName",className:"block text-sm font-medium text-foreground/80 mb-1",children:"Nom du projet"}),(0,r.jsx)(n.I,{type:"text",id:"projectName",placeholder:"Entrez le nom du projet",className:"bg-background",value:ep,onChange:e=>eh(e.target.value)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(i._,{htmlFor:"projectType",className:"block text-sm font-medium text-foreground/80 mb-1",children:"Type de projet"}),(0,r.jsxs)(R.Ph,{disabled:!!ef,children:[(0,r.jsx)(R.i4,{className:"bg-background",children:(0,r.jsx)(R.ki,{placeholder:"S\xe9lectionnez un type"})}),(0,r.jsxs)(R.Bw,{children:[(0,r.jsx)(R.Ql,{value:"individual",children:"Photos individuelles"}),(0,r.jsx)(R.Ql,{value:"class",children:"Photos de classe"}),(0,r.jsx)(R.Ql,{value:"event",children:"\xc9v\xe9nement sp\xe9cial"}),(0,r.jsx)(R.Ql,{value:"other",children:"Autre"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(i._,{className:"block text-sm font-medium text-foreground/80 mb-1",children:"Classes concern\xe9es"}),(0,r.jsx)("div",{className:"mt-2 space-y-2 max-h-32 overflow-y-auto",children:eg.length>0?eg.map(e=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(E,{id:"class-checkbox-".concat(e.id),disabled:!!ef}),(0,r.jsx)(i._,{htmlFor:"class-checkbox-".concat(e.id),className:"ml-2 text-sm text-foreground/80",children:e.name})]},e.id)):(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Aucune classe cr\xe9\xe9e. Veuillez en ajouter via la barre lat\xe9rale."})})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(i._,{htmlFor:"autoSync",className:"text-sm font-medium text-foreground/80",children:"Synchronisation automatique"}),(0,r.jsx)(J.r,{id:"autoSync",defaultChecked:!0,disabled:!!ef})]}),(0,r.jsx)("p",{className:"mt-1 text-xs text-muted-foreground",children:"Les photos seront automatiquement synchronis\xe9es lorsque vous \xeates en ligne."})]})]}),(0,r.jsxs)(L.cN,{children:[(0,r.jsx)(L.GG,{asChild:!0,children:(0,r.jsx)(l.z,{variant:"outline",children:"Annuler"})}),(0,r.jsx)(l.z,{onClick:eR,children:ef?"Enregistrer les modifications":"Cr\xe9er le projet"})]})]})]})]})]})})]}),(0,r.jsx)(L.Vq,{open:eN,onOpenChange:e=>{eb(e),e||ew("")},children:(0,r.jsxs)(L.cZ,{className:"sm:max-w-md",children:[(0,r.jsx)(L.fK,{children:(0,r.jsx)(L.$N,{children:"Ajouter une nouvelle classe"})}),(0,r.jsxs)("div",{className:"px-0 py-4",children:[(0,r.jsx)(i._,{htmlFor:"newClassName",className:"block text-sm font-medium text-foreground/80 mb-1",children:"Nom de la classe"}),(0,r.jsx)(n.I,{id:"newClassName",type:"text",placeholder:"Ex: CM2 B, Grande Section A",className:"bg-background",value:ey,onChange:e=>ew(e.target.value)})]}),(0,r.jsxs)(L.cN,{children:[(0,r.jsx)(l.z,{variant:"outline",onClick:()=>eb(!1),children:"Annuler"}),(0,r.jsx)(l.z,{onClick:()=>{let e=ey.trim();if(!e){s({title:"Nom de la classe requis",description:"Veuillez entrer un nom pour la classe.",variant:"destructive"});return}if(eg.some(s=>s.name.toLowerCase()===e.toLowerCase())){s({title:"Classe existante",description:'La classe "'.concat(e,'" existe d\xe9j\xe0.'),variant:"destructive"});return}let t={id:"class_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,7)),name:e};eA(e=>[...e,t]),s({title:"Classe cr\xe9\xe9e",description:'La classe "'.concat(t.name,'" a \xe9t\xe9 ajout\xe9e.')}),ew(""),eb(!1)},children:"Cr\xe9er la classe"})]})]})}),(0,r.jsx)(L.Vq,{open:ek,onOpenChange:ez,children:(0,r.jsxs)(L.cZ,{className:"sm:max-w-md",children:[(0,r.jsxs)(L.fK,{children:[(0,r.jsx)(L.$N,{children:"Importer des \xe9l\xe8ves pour un projet"}),(0,r.jsx)(L.Be,{children:"S\xe9lectionnez un projet et un fichier CSV (avec les colonnes: Pr\xe9nom, Nom, Classe)."})]}),(0,r.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,r.jsx)(i._,{htmlFor:"projectSelectForCsv",className:"text-right",children:"Projet"}),(0,r.jsxs)(R.Ph,{value:eZ||"",onValueChange:eI,children:[(0,r.jsx)(R.i4,{id:"projectSelectForCsv",className:"col-span-3 bg-background",children:(0,r.jsx)(R.ki,{placeholder:"S\xe9lectionnez un projet"})}),(0,r.jsx)(R.Bw,{children:t.map(e=>(0,r.jsx)(R.Ql,{value:e.id,children:e.name},e.id))})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,r.jsx)(i._,{htmlFor:"csvFileImport",className:"text-right",children:"Fichier CSV"}),(0,r.jsx)(n.I,{id:"csvFileImport",type:"file",accept:".csv",ref:eO,onChange:e=>e_(e.target.files?e.target.files[0]:null),className:"col-span-3"})]})]}),(0,r.jsxs)(L.cN,{children:[(0,r.jsx)(L.GG,{asChild:!0,children:(0,r.jsx)(l.z,{variant:"outline",onClick:()=>ez(!1),children:"Annuler"})}),(0,r.jsxs)(l.z,{onClick:eJ,children:[(0,r.jsx)(A.Z,{className:"mr-2 h-4 w-4"})," Importer"]})]})]})}),(0,r.jsx)(L.Vq,{open:H,onOpenChange:ei,children:(0,r.jsxs)(L.cZ,{className:"sm:max-w-md",children:[(0,r.jsx)(L.fK,{children:(0,r.jsx)(L.$N,{children:"Archiver ce projet ?"})}),(0,r.jsx)(L.Be,{className:"py-4",children:'Le projet sera d\xe9plac\xe9 vers les projets archiv\xe9s. Vous pourrez toujours y acc\xe9der via le filtre "Projets archiv\xe9s".'}),(0,r.jsxs)(L.cN,{children:[(0,r.jsx)(l.z,{variant:"outline",onClick:()=>{ei(!1),em(null)},children:"Annuler"}),(0,r.jsx)(l.z,{onClick:()=>{ei(!1),s({title:"Projet archiv\xe9",description:"Le projet a \xe9t\xe9 archiv\xe9 avec succ\xe8s."}),em(null)},children:"Confirmer l'archivage"})]})]})}),(0,r.jsx)(et.aR,{open:eo,onOpenChange:e=>{ec(e),e||ex(null)},children:(0,r.jsxs)(et._T,{children:[(0,r.jsx)(et.fY,{children:(0,r.jsx)(et.f$,{children:"\xcates-vous s\xfbr de vouloir supprimer ce projet?"})}),(0,r.jsx)(et.yT,{className:"py-4",children:"Cette action est irr\xe9versible. Toutes les donn\xe9es associ\xe9es \xe0 ce projet, y compris les photos et la liste des \xe9l\xe8ves, seront d\xe9finitivement supprim\xe9es."}),(0,r.jsxs)(et.xo,{children:[(0,r.jsx)(et.le,{onClick:()=>{ec(!1),ex(null),em(null)},children:"Annuler"}),(0,r.jsx)(et.OL,{asChild:!0,children:(0,r.jsx)(l.z,{variant:"destructive",onClick:eT,children:"Confirmer la suppression"})})]})]})})]})}},767:function(e,s,t){"use strict";t.d(s,{OL:function(){return j},_T:function(){return u},aR:function(){return o},f$:function(){return h},fY:function(){return x},le:function(){return g},vW:function(){return c},xo:function(){return p},yT:function(){return f}});var r=t(7437),a=t(2265),l=t(277),n=t(3448),i=t(2381);let o=l.fC,c=l.xz,d=l.h_,m=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(l.aV,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s})});m.displayName=l.aV.displayName;let u=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsxs)(d,{children:[(0,r.jsx)(m,{}),(0,r.jsx)(l.VY,{ref:s,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a})]})});u.displayName=l.VY.displayName;let x=e=>{let{className:s,...t}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};x.displayName="AlertDialogHeader";let p=e=>{let{className:s,...t}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};p.displayName="AlertDialogFooter";let h=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(l.Dx,{ref:s,className:(0,n.cn)("text-lg font-semibold",t),...a})});h.displayName=l.Dx.displayName;let f=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(l.dk,{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...a})});f.displayName=l.dk.displayName;let j=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(l.aU,{ref:s,className:(0,n.cn)((0,i.d)(),t),...a})});j.displayName=l.aU.displayName;let g=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(l.$j,{ref:s,className:(0,n.cn)((0,i.d)({variant:"outline"}),"mt-2 sm:mt-0",t),...a})});g.displayName=l.$j.displayName},4589:function(e,s,t){"use strict";t.d(s,{r:function(){return i}});var r=t(7437),a=t(2265),l=t(721),n=t(3448);let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(l.fC,{className:(0,n.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:s,children:(0,r.jsx)(l.bU,{className:(0,n.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});i.displayName=l.fC.displayName}},function(e){e.O(0,[284,648,0,176,147,960,971,117,744],function(){return e(e.s=3647)}),_N_E=e.O()}]);