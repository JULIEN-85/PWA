(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790],{4685:function(e,t,r){Promise.resolve().then(r.bind(r,2444))},2735:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},3245:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},8462:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]])},2444:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return L}});var a=r(7437),s=r(3145),l=r(7648),n=r(2265),i=r(9376),c=r(7603),o=r(9918),d=r(3270),u=r(2381),m=r(9820),p=r(641),h=r(279),f=r(5060),x=r(4291),g=r(5291),v=r(3340),j=r(1841),b=r(8421),N=r(5005),y=r(9763);let w=(0,y.Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),k=(0,y.Z)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var C=r(8462),S=r(2735);let P=(0,y.Z)("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),z=(0,y.Z)("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);var I=r(2660);let Z=(0,y.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var E=r(3581),A=r(3245),V=r(8930),_=r(3448);let R=(0,r(535).j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),D=n.forwardRef((e,t)=>{let{className:r,variant:s,...l}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,_.cn)(R({variant:s}),r),...l})});D.displayName="Alert";let O=n.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h5",{ref:t,className:(0,_.cn)("mb-1 font-medium leading-none tracking-tight",r),...s})});O.displayName="AlertTitle";let M=n.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,_.cn)("text-sm [&_p]:leading-relaxed",r),...s})});M.displayName="AlertDescription";let F="photoClassProjectStudents_";function L(){var e,t;let{toast:r}=(0,v.pm)(),y=(0,i.useRouter)(),R=(0,n.useRef)(null),L=(0,n.useRef)(null),W=(0,n.useRef)(null),{stream:q,error:U,isWebcamActive:J,startWebcam:H,stopWebcam:T,capturePhoto:Y,setError:G}=function(e){let{videoRef:t,canvasRef:r}=e,[a,s]=(0,n.useState)(null),[l,i]=(0,n.useState)(null),[c,o]=(0,n.useState)(!1),d=(0,n.useCallback)(async()=>{if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)try{let e=await navigator.mediaDevices.getUserMedia({video:!0});s(e),t.current&&(t.current.srcObject=e),i(null),o(!0)}catch(e){console.error("Error accessing webcam:",e),e instanceof Error?i("Error accessing webcam: ".concat(e.message,". Please ensure permissions are granted.")):i("An unknown error occurred while accessing the webcam."),o(!1)}else i("Webcam access is not supported by this browser."),o(!1)},[t]),u=(0,n.useCallback)(()=>{a&&(a.getTracks().forEach(e=>e.stop()),s(null),o(!1),t.current&&(t.current.srcObject=null))},[a,t]),m=(0,n.useCallback)(()=>{if(t.current&&r.current&&a){let e=t.current,a=r.current;a.width=e.videoWidth,a.height=e.videoHeight;let s=a.getContext("2d");if(s)return s.drawImage(e,0,0,a.width,a.height),a.toDataURL("image/jpeg")}return null},[t,r,a]);return{stream:a,error:l,isWebcamActive:c,startWebcam:d,stopWebcam:u,capturePhoto:m,setError:i}}({videoRef:R,canvasRef:L}),[B,K]=(0,n.useState)(null),[Q,$]=(0,n.useState)([]),[X,ee]=(0,n.useState)(0),[et,er]=(0,n.useState)({}),[ea,es]=(0,n.useState)(!0),[el,en]=(0,n.useState)(!0),[ei,ec]=(0,n.useState)(!1),[eo,ed]=(0,n.useState)(""),[eu,em]=(0,n.useState)(""),[ep,eh]=(0,n.useState)(""),[ef,ex]=(0,n.useState)([]),eg=Q[X];(0,n.useEffect)(()=>{en(!0);let e=null;try{let t=localStorage.getItem("projectConfig");if(t){let r=JSON.parse(t);if(r.projectId&&r.projectName&&r.sessionDate)K(r),e=r;else throw Error("Configuration de projet invalide (projectId, projectName, ou sessionDate manquant).")}else throw Error("Aucune configuration de projet trouv\xe9e.")}catch(e){console.warn("Project config error:",e),r({variant:"destructive",title:"Configuration requise",description:e.message||"Veuillez configurer le projet avant de continuer.",duration:5e3}),y.replace("/");return}let t=localStorage.getItem("photoClassAppSchoolClasses");if(t)try{let e=JSON.parse(t);ex(Array.isArray(e)?e:[])}catch(e){console.error("Failed to parse school classes from localStorage",e),ex([])}if(null==e?void 0:e.projectId){let t=localStorage.getItem("".concat(F).concat(e.projectId));if(t)try{let e=JSON.parse(t);$(e.length>0?e:[])}catch(e){console.error("Failed to parse project students from localStorage",e),$([])}else $([]);ee(0)}en(!1)},[y,r]),(0,n.useEffect)(()=>{let e=async()=>{if(eg&&B){es(!0);try{let e=await (0,j.SY)(eg.id,B.projectId);er(t=>({...t,[eg.id]:e}))}catch(e){console.error("Failed to load photos for student",e),r({variant:"destructive",title:"Erreur chargement photos",description:"Impossible de charger les photos de l'\xe9l\xe8ve."})}finally{es(!1)}}};eg&&(null==B?void 0:B.projectId)?e():eg||es(!1)},[eg,B,r]),(0,n.useEffect)(()=>{U&&r({variant:"destructive",title:"Erreur Webcam",description:U})},[U,r]);let ev=async()=>{if(!eg||!B)return;let e=Y();if(e){var t;let a=Date.now(),s={id:"".concat(eg.id,"_").concat(B.projectId,"_").concat(a),studentId:eg.id,projectId:B.projectId,photoDataUrl:e,fileName:"".concat(eg.className.replace(/\s+/g,"-"),"_").concat(eg.lastName,"_").concat(eg.firstName,"_").concat(((null===(t=et[eg.id])||void 0===t?void 0:t.length)||0)+1,".jpg"),timestamp:a};try{await (0,j.Ju)(s),er(e=>({...e,[eg.id]:[...e[eg.id]||[],s]})),r({title:"Photo captur\xe9e !",description:"Photo sauvegard\xe9e pour ".concat(eg.firstName," ").concat(eg.lastName,".")}),X<Q.length-1?ee(e=>e+1):r({title:"Tous les \xe9l\xe8ves trait\xe9s !",description:"Vous avez atteint la fin de la liste."})}catch(e){r({variant:"destructive",title:"Erreur sauvegarde photo",description:"Impossible de sauvegarder la photo localement."})}}else r({variant:"destructive",title:"Capture \xe9chou\xe9e",description:"Impossible de capturer la photo depuis la webcam."})},ej=async(e,t)=>{try{await (0,j.JJ)(e),er(r=>({...r,[t]:(r[t]||[]).filter(t=>t.id!==e)})),r({title:"Photo supprim\xe9e",description:"La photo a \xe9t\xe9 enlev\xe9e."})}catch(e){r({variant:"destructive",title:"Erreur suppression photo",description:"Impossible de supprimer la photo."})}},eb=async()=>{if(!B){r({variant:"destructive",title:"Projet non configur\xe9",description:"Veuillez configurer le projet avant d'exporter."});return}let e=await (0,j.Gq)(B.projectId);if(0===e.length&&0===Q.length){r({variant:"destructive",title:"Rien \xe0 exporter",description:"Aucune photo ni \xe9l\xe8ve pour ce projet."});return}let t="";e.length>0?t=e.map(e=>{let t=Q.find(t=>t.id===e.studentId);return t?"".concat(t.className,",").concat(t.lastName,",").concat(t.firstName,",").concat(e.fileName,"\n"):""}).join(""):Q.length>0&&(t=Q.map(e=>"".concat(e.className,",").concat(e.lastName,",").concat(e.firstName,",\n")).join(""));let a="Classe,Nom,Pr\xe9nom,FichierPhoto\n"+t,s=new Blob(["Projet: ".concat(B.projectName,"\nDate S\xe9ance: ").concat((0,c.Z)((0,o.Z)(B.sessionDate),"PPP",{locale:d.Z}),"\n\n")+a],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(s),n=document.createElement("a");n.href=l,n.setAttribute("download","export_".concat(B.projectName.replace(/\s+/g,"_"),"_").concat(B.sessionDate,".csv")),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(l),r({title:"CSV Export\xe9",description:"La liste CSV des photos des \xe9l\xe8ves a \xe9t\xe9 t\xe9l\xe9charg\xe9e."}),e.length>0&&(console.log("Simulating ZIP export of photos:",e.map(e=>e.fileName)),r({title:"Export des photos (Simulation)",description:"La simulation de l'export ZIP est dans la console."}))},eN=async()=>{if(B&&window.confirm('\xcates-vous s\xfbr de vouloir effacer toutes les photos captur\xe9es pour le projet "'.concat(B.projectName,'" ? Cette action est irr\xe9versible.')))try{await (0,j.tD)(B.projectId),er({}),eg&&er(e=>({...e,[eg.id]:[]})),r({title:"Donn\xe9es du projet effac\xe9es",description:'Toutes les photos pour "'.concat(B.projectName,'" ont \xe9t\xe9 supprim\xe9es.')})}catch(e){r({variant:"destructive",title:"Erreur suppression",description:"Impossible de supprimer les photos du projet."})}};if(el)return(0,a.jsxs)("div",{className:"flex h-screen flex-col bg-background text-foreground",children:[(0,a.jsx)("header",{className:"sticky top-0 z-10 flex items-center justify-between p-4 border-b border-border/60 shadow-sm bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,a.jsx)(b.Y,{})}),(0,a.jsx)("main",{className:"flex-1 flex items-center justify-center",children:(0,a.jsx)("p",{className:"text-lg text-muted-foreground",children:"Chargement de la configuration du projet..."})})]});if(!B)return(0,a.jsxs)("div",{className:"flex h-screen flex-col bg-background text-foreground",children:[(0,a.jsxs)("header",{className:"sticky top-0 z-10 flex items-center justify-between p-4 border-b border-border/60 shadow-sm bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[(0,a.jsx)(b.Y,{}),(0,a.jsx)(l.default,{href:"/",passHref:!0,children:(0,a.jsxs)(u.z,{variant:"default",size:"lg",children:[(0,a.jsx)(N.Z,{className:"mr-2 h-5 w-5"})," Configurer le Projet"]})})]}),(0,a.jsx)("main",{className:"flex-1 flex items-center justify-center p-6",children:(0,a.jsxs)(D,{variant:"destructive",className:"max-w-md",children:[(0,a.jsx)(w,{className:"h-5 w-5"}),(0,a.jsx)(O,{children:"Projet non configur\xe9"}),(0,a.jsx)(M,{children:"Veuillez configurer un nom de projet et une date de s\xe9ance avant de prendre des photos."})]})})]});let ey=!!B;return(0,a.jsxs)("div",{className:"flex h-screen flex-col bg-background text-foreground",children:[(0,a.jsxs)("header",{className:"sticky top-0 z-50 flex flex-wrap items-center justify-between gap-2 p-4 border-b border-border/60 shadow-sm bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[(0,a.jsx)(b.Y,{}),B&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground text-center order-last lg:order-none lg:absolute lg:left-1/2 lg:-translate-x-1/2",children:(0,a.jsxs)("p",{className:"truncate",children:[(0,a.jsx)("span",{className:"font-semibold text-primary",children:B.projectName})," - S\xe9ance du ",(0,c.Z)((0,o.Z)(B.sessionDate),"PPP",{locale:d.Z})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l.default,{href:"/",passHref:!0,children:(0,a.jsxs)(u.z,{variant:"outline",size:"lg",className:"bg-card hover:bg-muted","aria-label":"Aller \xe0 la gestion de projet",children:[(0,a.jsx)(N.Z,{className:"mr-2 h-5 w-5"})," Projets"]})}),(0,a.jsxs)(u.z,{variant:"outline",size:"lg",onClick:()=>{var e;ed(""),em(""),eh((null===(e=ef[0])||void 0===e?void 0:e.name)||""),ec(!0)},disabled:!ey,className:"bg-card hover:bg-muted","aria-label":"Ajouter un \xe9l\xe8ve manuellement",children:[(0,a.jsx)(k,{className:"mr-2 h-5 w-5"})," Ajouter \xc9l\xe8ve"]}),(0,a.jsxs)(u.z,{variant:"outline",size:"lg",onClick:()=>{var e;return null===(e=W.current)||void 0===e?void 0:e.click()},disabled:!ey,className:"bg-card hover:bg-muted","aria-label":"Import CSV \xc9l\xe8ves",children:[(0,a.jsx)(C.Z,{className:"mr-2 h-5 w-5"})," Importer CSV \xc9l\xe8ves"]}),(0,a.jsx)(h.I,{type:"file",accept:".csv",ref:W,onChange:e=>{var t;if(!B){r({variant:"destructive",title:"Projet non configur\xe9",description:"Veuillez s\xe9lectionner un projet avant d'importer des \xe9l\xe8ves."});return}let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){let e=new FileReader;e.onload=e=>{var t;let a=null===(t=e.target)||void 0===t?void 0:t.result;if(!a){r({variant:"destructive",title:"Fichier vide",description:"Le fichier CSV s\xe9lectionn\xe9 est vide."});return}try{let e=a.split(/\r\n|\n/).filter(e=>""!==e.trim());if(e.length<=1){r({variant:"destructive",title:"Format CSV incorrect",description:"Le fichier CSV doit contenir un en-t\xeate et au moins une ligne de donn\xe9es."});return}let t=e[0].split(",").map(e=>e.trim().toLowerCase()),s=t.indexOf("pr\xe9nom"),l=t.indexOf("nom"),n=t.indexOf("classe");if(-1===s||-1===l||-1===n){r({variant:"destructive",title:"En-t\xeates CSV manquants",description:"Le CSV doit contenir les colonnes: Pr\xe9nom, Nom, Classe."});return}let i=e.slice(1).map((e,t)=>{let r=e.split(",").map(e=>e.trim());return{id:"student_".concat(B.projectId,"_").concat(Date.now(),"_").concat(t),firstName:r[s]||"Pr\xe9nomInconnu".concat(t),lastName:r[l]||"NomInconnu".concat(t),className:r[n]||"ClasseInconnue"}});i.length>0?($(i),ee(0),localStorage.setItem("".concat(F).concat(B.projectId),JSON.stringify(i)),r({title:"\xc9l\xe8ves import\xe9s",description:"".concat(i.length," \xe9l\xe8ves import\xe9s avec succ\xe8s pour le projet ").concat(B.projectName,".")})):r({variant:"destructive",title:"Aucun \xe9l\xe8ve import\xe9",description:"Aucun \xe9l\xe8ve n'a \xe9t\xe9 trouv\xe9 dans le fichier CSV."})}catch(e){console.error("Error parsing CSV:",e),r({variant:"destructive",title:"Erreur de parsing CSV",description:"Impossible de lire le fichier CSV. V\xe9rifiez son format."})}},e.readAsText(a)}W.current&&(W.current.value="")},className:"hidden"}),(0,a.jsxs)(u.z,{variant:"outline",size:"lg",onClick:eb,disabled:!ey,className:"bg-card hover:bg-muted","aria-label":"Export Photos and CSV",children:[(0,a.jsx)(S.Z,{className:"mr-2 h-5 w-5"})," Export"]}),(0,a.jsxs)(u.z,{variant:J?"destructive":"default",size:"lg",onClick:J?T:()=>{G(null),H()},disabled:!ey,"aria-label":J?"Stop Webcam":"Start Webcam",children:[J?(0,a.jsx)(P,{className:"mr-2 h-5 w-5"}):(0,a.jsx)(z,{className:"mr-2 h-5 w-5"}),J?"Stop Cam":"Start Cam"]})]})]}),(0,a.jsxs)("main",{className:"flex-1 flex flex-col lg:flex-row p-4 gap-4 overflow-hidden",children:[(0,a.jsxs)(m.Zb,{className:(0,_.cn)("lg:w-1/3 flex flex-col shadow-lg bg-card",!ey&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(m.Ol,{children:(0,a.jsx)(m.ll,{className:"text-xl",children:"\xc9l\xe8ve Actuel"})}),(0,a.jsxs)(m.aY,{className:"flex-1 flex flex-col items-center justify-center text-center p-6",children:[Q.length>0&&eg?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:eg.className}),(0,a.jsx)("p",{className:"text-5xl md:text-6xl font-bold my-4 text-primary truncate max-w-full px-2",title:"".concat(eg.firstName," ").concat(eg.lastName),children:eg.firstName}),(0,a.jsx)("p",{className:"text-5xl md:text-6xl font-bold mb-4 text-primary truncate max-w-full px-2",children:eg.lastName}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[X+1," / ",Q.length]})]}):(0,a.jsx)("p",{className:"text-muted-foreground",children:"Aucun \xe9l\xe8ve disponible. Veuillez importer ou ajouter des \xe9l\xe8ves."}),ea&&Q.length>0&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Chargement des photos de l'\xe9l\xe8ve..."})]}),(0,a.jsxs)(m.eW,{className:"flex justify-between p-4 border-t border-border/60",children:[(0,a.jsxs)(u.z,{variant:"outline",size:"lg",onClick:()=>{X>0?ee(e=>e-1):r({title:"D\xe9but de la liste",description:"Vous \xeates au premier \xe9l\xe8ve."})},disabled:0===X||!ey||0===Q.length,className:"bg-background hover:bg-muted","aria-label":"Previous Student",children:[(0,a.jsx)(I.Z,{className:"mr-2 h-5 w-5"})," Pr\xe9c."]}),(0,a.jsxs)(u.z,{variant:"outline",size:"lg",onClick:()=>{X<Q.length-1?ee(e=>e+1):r({title:"Fin de la liste",description:"Vous \xeates au dernier \xe9l\xe8ve."})},disabled:X===Q.length-1||!ey||0===Q.length,className:"bg-background hover:bg-muted","aria-label":"Next Student",children:["Suiv. ",(0,a.jsx)(Z,{className:"ml-2 h-5 w-5"})]})]})]}),(0,a.jsxs)(m.Zb,{className:(0,_.cn)("lg:w-2/3 flex flex-col shadow-lg overflow-hidden bg-card",!ey&&"opacity-50 pointer-events-none"),children:[(0,a.jsx)(m.Ol,{children:(0,a.jsx)(m.ll,{className:"text-xl",children:"Capture Photo"})}),(0,a.jsxs)(m.aY,{className:"flex-1 flex flex-col items-center justify-center relative p-2 md:p-4",children:[(0,a.jsxs)("div",{className:"w-full aspect-video bg-muted rounded-md shadow-inner overflow-hidden relative",children:[(0,a.jsx)("video",{ref:R,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-contain"}),(!J||U)&&ey&&(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-muted/80 backdrop-blur-sm rounded-md p-4 text-center",children:[(0,a.jsx)(E.Z,{className:"w-16 h-16 text-muted-foreground mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:U?"Erreur Webcam":"Webcam inactive."}),U&&(0,a.jsxs)("p",{className:"text-destructive text-sm mt-2 flex items-center justify-center",children:[(0,a.jsx)(w,{className:"w-4 h-4 mr-1 flex-shrink-0"}),(0,a.jsx)("span",{className:"break-words max-w-xs",children:U.replace("Error accessing webcam: ","").replace(" Please ensure permissions are granted.","")})]}),(0,a.jsx)(u.z,{onClick:()=>{G(null),H()},className:"mt-4",size:"lg","aria-label":"Activer la webcam",children:J&&U?"R\xe9essayer Webcam":"Activer Webcam"})]})]}),!ey&&(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-muted/90 backdrop-blur-sm rounded-md shadow-inner p-4 text-center",children:[(0,a.jsx)(A.Z,{className:"w-16 h-16 text-primary mb-4"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:"Projet non configur\xe9"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Veuillez configurer le projet pour activer la capture."}),(0,a.jsx)(l.default,{href:"/",passHref:!0,children:(0,a.jsx)(u.z,{size:"lg",children:"Configurer le Projet"})})]}),(0,a.jsx)("canvas",{ref:L,className:"hidden"})]}),(0,a.jsxs)(m.eW,{className:"flex flex-col p-4 border-t border-border/60",children:[(0,a.jsxs)(u.z,{size:"lg",className:"w-full mb-4 bg-primary hover:bg-primary/90 text-primary-foreground py-6 text-xl",onClick:ev,disabled:!J||!eg||!ey||ea||0===Q.length,"aria-label":"Capture Photo",children:[(0,a.jsx)(E.Z,{className:"mr-2 h-6 w-6"})," Capturer Photo"]}),eg&&(null!==(t=null===(e=et[eg.id])||void 0===e?void 0:e.length)&&void 0!==t?t:0)>0&&(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsxs)("h3",{className:"text-sm font-medium mb-2 text-muted-foreground",children:["Captures pour ",eg.firstName,":"]}),(0,a.jsx)(p.x,{className:"h-24 w-full",children:(0,a.jsx)("div",{className:"flex gap-2 pb-2",children:(et[eg.id]||[]).map(e=>(0,a.jsxs)("div",{className:"relative group shrink-0",children:[(0,a.jsx)(s.default,{src:e.photoDataUrl,alt:"Photo pour ".concat(eg.firstName),width:80,height:60,className:"rounded-md object-cover w-20 h-[60px] border border-border/60"}),(0,a.jsx)(u.z,{variant:"destructive",size:"icon",className:"absolute top-0 right-0 w-6 h-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>ej(e.id,eg.id),"aria-label":"Delete Photo",disabled:!ey,children:(0,a.jsx)(V.Z,{className:"w-3 h-3"})})]},e.id))})})]})]})]})]}),(0,a.jsx)("footer",{className:"p-2 text-center border-t border-border/60",children:(0,a.jsxs)(u.z,{variant:"link",size:"sm",onClick:eN,className:"text-destructive hover:text-destructive/80",disabled:!ey,children:[(0,a.jsx)(V.Z,{className:"mr-1 h-3 w-3"})," Effacer les photos du projet actuel"]})}),(0,a.jsx)(x.Vq,{open:ei,onOpenChange:ec,children:(0,a.jsxs)(x.cZ,{className:"sm:max-w-md",children:[(0,a.jsx)(x.fK,{children:(0,a.jsx)(x.$N,{children:"Ajouter un nouvel \xe9l\xe8ve"})}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(f._,{htmlFor:"firstName",className:"text-right",children:"Pr\xe9nom"}),(0,a.jsx)(h.I,{id:"firstName",value:eo,onChange:e=>ed(e.target.value),className:"col-span-3 bg-background",placeholder:"Pr\xe9nom de l'\xe9l\xe8ve"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(f._,{htmlFor:"lastName",className:"text-right",children:"Nom"}),(0,a.jsx)(h.I,{id:"lastName",value:eu,onChange:e=>em(e.target.value),className:"col-span-3 bg-background",placeholder:"Nom de l'\xe9l\xe8ve"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(f._,{htmlFor:"className",className:"text-right",children:"Classe"}),ef.length>0?(0,a.jsxs)(g.Ph,{value:ep,onValueChange:eh,children:[(0,a.jsx)(g.i4,{className:"col-span-3 bg-background",children:(0,a.jsx)(g.ki,{placeholder:"S\xe9lectionnez une classe"})}),(0,a.jsx)(g.Bw,{children:ef.map(e=>(0,a.jsx)(g.Ql,{value:e.name,children:e.name},e.id))})]}):(0,a.jsx)(h.I,{id:"className",value:ep,onChange:e=>eh(e.target.value),className:"col-span-3 bg-background",placeholder:"Ex: CP A (Aucune classe configur\xe9e)"})]})]}),(0,a.jsxs)(x.cN,{children:[(0,a.jsx)(x.GG,{asChild:!0,children:(0,a.jsx)(u.z,{variant:"outline",children:"Annuler"})}),(0,a.jsx)(u.z,{onClick:()=>{if(!B){r({variant:"destructive",title:"Erreur Projet",description:"Aucun projet actif pour ajouter cet \xe9l\xe8ve."});return}if(!eo.trim()||!eu.trim()||!ep.trim()){r({variant:"destructive",title:"Champs manquants",description:"Veuillez remplir Pr\xe9nom, Nom et Classe."});return}let e={id:"student_".concat(B.projectId,"_").concat(Date.now(),"_manual_").concat(Q.length),firstName:eo.trim(),lastName:eu.trim(),className:ep.trim()},t=[...Q,e];$(t),localStorage.setItem("".concat(F).concat(B.projectId),JSON.stringify(t)),r({title:"\xc9l\xe8ve ajout\xe9",description:"".concat(e.firstName," ").concat(e.lastName," a \xe9t\xe9 ajout\xe9 \xe0 la liste.")}),ec(!1)},children:"Sauvegarder \xc9l\xe8ve"})]})]})})]})}},9820:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},Zb:function(){return n},aY:function(){return o},eW:function(){return d},ll:function(){return c}});var a=r(7437),s=r(2265),l=r(3448);let n=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});n.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});c.displayName="CardTitle",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",r),...s})}).displayName="CardDescription";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",r),...s})});o.displayName="CardContent";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",r),...s})});d.displayName="CardFooter"},641:function(e,t,r){"use strict";r.d(t,{x:function(){return i}});var a=r(7437),s=r(2265),l=r(3643),n=r(3448);let i=s.forwardRef((e,t)=>{let{className:r,children:s,...i}=e;return(0,a.jsxs)(l.fC,{ref:t,className:(0,n.cn)("relative overflow-hidden",r),...i,children:[(0,a.jsx)(l.l_,{className:"h-full w-full rounded-[inherit]",children:s}),(0,a.jsx)(c,{}),(0,a.jsx)(l.Ns,{})]})});i.displayName=l.fC.displayName;let c=s.forwardRef((e,t)=>{let{className:r,orientation:s="vertical",...i}=e;return(0,a.jsx)(l.gb,{ref:t,orientation:s,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...i,children:(0,a.jsx)(l.q4,{className:"relative flex-1 rounded-full bg-border"})})});c.displayName=l.gb.displayName}},function(e){e.O(0,[284,648,0,176,288,960,971,117,744],function(){return e(e.s=4685)}),_N_E=e.O()}]);